kind: ConfigMap
apiVersion: v1
metadata:
  name: v11y_api_config
  namespace: "{{ tpa_single_node_namespace }}"
  labels:
    app: v11y-api
    component: v11y

data:
  auth.yaml: |
    authentication:
      clients:
        - clientId: "{{ tpa_single_node_oidc_frontend }}"
          issuerUrl: "{{ tpa_single_node_oidc_issuer_url }}"
          additionalPermissions:
            - "read.sbom"
            - "read.vex"
            - "read.cve"
          groupSelector: "$.['cognito:groups'][*]"
          groupMappings:
            manager:
              - "create.sbom"
              - "create.vex"
              - "update.sbom"
              - "update.vex"
              - "delete.sbom"
              - "delete.vex"


        - clientId: "{{ tpa_single_node_oidc_walker }}"
          issuerUrl: "{{ tpa_single_node_oidc_issuer_url }}"
          scopeMappings:
            "trustification/bombastic":
              - "create.sbom"
              - "read.sbom"
              - "update.sbom"
              - "delete.sbom"
            "trustification/vexination":
              - "create.vex"
              - "read.vex"
              - "update.vex"
              - "delete.vex"
            "trustification/v11y":
              - "read.cve"
